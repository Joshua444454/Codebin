{
    "author": "Manish",
    "language": "javascript",
    "content": "var express = require('express');\r\nvar fs = require('fs');\r\nvar bodyParser = require('body-parser')\r\nvar app = express(); \r\nvar async = require('async');\r\n\r\nvar port = 5000;\r\n\r\nvar urlencodedParser = bodyParser.urlencoded({ extended: false })\r\n\r\n\r\napp.use(express.static('public'));\r\n\r\napp.set('views','./src/views');\r\napp.set('view engine', 'ejs');\t\r\n\r\napp.get('/', function(req,res){\r\n\tres.render('index', { title: 'Hackathon Pastebin' });\r\n\t// res.sendFile(__dirname + '/src/views/test.html');\r\n});\r\n\r\napp.get('/:id', function(req,res){\r\n\tvar path = __dirname + \"/files/\" + req.params.id + '.txt';\r\n\tfs.readFile(path, 'utf8', function (err,data) {\r\n  \t\tif (err) {\r\n    \t\tres.send(\"File does not exist\");\r\n  \t\t}else{\r\n\r\n\r\n\t  \t\tvar metadata = JSON.parse(data);\r\n\t  \t\tvar author = metadata.author;\r\n\t  \t\tvar language = metadata['language'];\r\n\t  \t\tvar content = metadata['content'];\r\n\t  \t\tvar timestamp =  metadata.timestamp;\r\n\t  \t\tvar date = metadata.date;\r\n\r\n\t  \t\tres.render('paste',{\r\n\t  \t\t\tauthor: author,\r\n\t  \t\t\tlanguage: language,\r\n\t  \t\t\tcontent: content,\r\n\t  \t\t\ttimestamp : timestamp,\r\n\t  \t\t\tdate : date\r\n\t\t\t});\r\n\t\t}\t\t\r\n\t});\r\n});\r\n\r\n\r\napp.post('/', urlencodedParser , function(req,res){\r\n\t\r\n\tvar author = req.body.poster;\t\r\n\tvar language = req.body.syntax;\t\r\n\tvar content = req.body.content;\r\n\tvar timestamp = Date.now().toString().substring(6);\r\n\tvar date = Date();\r\n\t\r\n\r\n\tvar metadata = {\r\n\r\n\t\tauthor : author,\r\n\t\tlanguage : language,\r\n\t\tcontent : content,\r\n\t\ttimestamp : timestamp,\r\n\t\tdate : date\r\n\t};\r\n\tvar path = __dirname + \"/files/\" + timestamp+ '.txt';\r\n\r\n\tfs.writeFile(path, JSON.stringify(metadata,null,4), function (err) {\r\n  \t\tif (err) return console.log(err);\r\n  \t\t\tres.redirect('/' + timestamp);\r\n  \t});\r\n\tconsole.log('File saved-' + timestamp+'.txt');\r\n\r\n});\r\n\r\napp.listen(port , function(err)\t{\r\n\tconsole.log('running server on port:'+ port);\r\n\r\n}); \t",
    "timestamp": "4603212",
    "date": "Wed Apr 06 2016 01:00:03 GMT+0530 (IST)"
}